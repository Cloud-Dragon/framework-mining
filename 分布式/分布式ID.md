

# 分布式ID

## 为什么需要分布式ID

随着数据量增大，数据库会采用分库分表，这时数据库自增ID便不能作为全局唯一主键，需引入全局唯一ID生成服务



## 常用解决方案

## UUID（Universally Unique Identifier，通用唯一识别码）

形式为8-4-4-4-1，由32个字符以及4个横线组成，占36Byte，示例：550e8400-e29b-41d4-a716-446655440000

UUID理论上的总数为1632=2128，约等于3.4 x 1038。也就是说若每[纳秒](https://zh.wikipedia.org/wiki/%E7%BA%B3%E7%A7%92)产生1[兆](https://zh.wikipedia.org/wiki/%E5%85%86)个UUID，要花100亿年才会将所有UUID用完，而其重复的概率也是微乎其微，几乎无需关心。

使用：

- 优点：
  - 本地生成，操作简单
  - 不需要中心服务，减小实现复杂度，基本无性能上限
  - 无需额外网络请求，低延迟
- 缺点
  - 长度过大，需36Byte。作为索引，增大存储空间需求。
  - 无序，作为主键索引，插入时会频繁改动索引结构，降低查询效率

## 数据库自增ID

利用数据库自增的特性，向数据库中插入数据并获取到自增ID，

需要基于数据库建立一个额外的中心服务，每次需要生成ID请求服务即可。

- 优点
- 缺点
  1. 

##  雪花算法（snowflake）

- 优点
  1. 有序，保证呈递增趋势，可以减少索引操作；
  2. 字段相对较短，64bit，占8Byte，只需要一个bigint就可以存下.
- 缺点
  1. 需用户自己定义机器ID，这显然是比较麻烦。
  2. 存在时钟回滚的风险，始终回滚有可能会导致出现重复





https://juejin.im/post/5bb0217ef265da0ac2567b42?utm_source=gold_browser_extension